CRITICAL PROJECT RULES (P0 - NEVER VIOLATE)
Generated: 2025-11-23 | Token Budget: ~1000 | Load Priority: CRITICAL

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. FILE ORGANIZATION (P0 - MANDATORY)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ZERO ROOT POLLUTION POLICY - Before creating ANY file, check:

âœ… ALLOWED AT ROOT (ONLY):
- .gitignore, .gitattributes, .editorconfig
- .claude.json, .mcp.json
- README.md, LICENSE
- *.sln, *.csproj (Unity/VS project files)

âŒ AUTO-REDIRECT REQUIRED:
AI reports/analysis     â†’ claudedocs/reports/
AI action items         â†’ claudedocs/action-items/
AI guides/tutorials     â†’ claudedocs/guides/
User documentation      â†’ docs/
Temporary files         â†’ .temp/ (gitignored)
Tests                   â†’ Assets/Tests/ or tests/
Scripts                 â†’ scripts/

ENFORCEMENT: Never ask user - just redirect automatically!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. DEPRECATIONS (P0 - NEVER RECOMMEND)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â›” DEPRECATED: serena-network (scripts/serena-network/)
   â”œâ”€ Reason: Overcomplicated neural network concept
   â”œâ”€ Replacement: Use .serena/memories/ with standard Serena MCP
   â”œâ”€ Actions: NEVER recommend setup-nightly-task.ps1, YAML processing
   â””â”€ Status: Marked with DEPRECATED.md, safe to delete

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. NETWORK ARCHITECTURE (P0 - NEVER FORGET)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš¨ NetworkTransform INTENTIONALLY REMOVED from player prefabs
   â”œâ”€ Reason: Conflicts with CharacterController, causes jitter
   â”œâ”€ Replacement: NetworkCharacterAdapter (state-based sync)
   â”œâ”€ Expected: Compilation errors about NetworkTransform (GOOD!)
   â””â”€ Pattern: character.GetComponent<NetworkCharacterAdapter>() âœ…

âœ… BEFORE character spawn: character.IsNetworkSpawned = true
âœ… Ownership check: if (character.IsNetworkOwner) { }
âœ… Movement: Server-authoritative via ServerRpc
âŒ NEVER: Add NetworkTransform back (breaks architecture)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. GAMECREATOR PATTERNS (P0 - STRICT SIGNATURES)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Visual Scripting Signatures (EXACT):
â”œâ”€ Instructions: protected override Task Run(Args args)
â”œâ”€ Conditions:   protected override bool Check(Args args)
â””â”€ âŒ NO CancellationToken, NO other parameters!

RPC Naming (MANDATORY):
â”œâ”€ ServerRpc: Must end with "ServerRpc"
â”œâ”€ ClientRpc: Must end with "ClientRpc"
â””â”€ Custom structs: Must implement INetworkSerializable

Character Ownership:
â”œâ”€ Invasive integration: IsNetworkOwner added to Character class
â”œâ”€ Before input: if (character.IsNetworkOwner) { ... }
â””â”€ Player reference: character.Player.IsOwner

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. SYMBOL REFERENCES (Quick Navigation)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CRITICAL MEMORIES (Always load first):
â”œâ”€ .serena/memories/CRITICAL/001_gamecreator_invasive_integration.md
â”œâ”€ .serena/memories/CRITICAL/002_network_architecture_never_forget.md
â”œâ”€ .serena/memories/CRITICAL/003_multiplayer_rpc_patterns.md
â””â”€ .serena/memories/CRITICAL/004_visual_scripting_task_signatures.md

TOOLS & WORKFLOWS:
â”œâ”€ .serena/memories/TOOLS/001_slash_commands_reference.md
â”œâ”€ .serena/memories/TOOLS/002_unity_mcp_integration.md
â”œâ”€ .serena/memories/TOOLS/003_openspec_workflow.md
â”œâ”€ .serena/memories/TOOLS/004_project_brain_integration.md
â”œâ”€ .serena/memories/TOOLS/005_testing_patterns.md
â””â”€ .serena/memories/TOOLS/006_file_organization_rules.md (THIS FILE)

SYMBOL MAPS:
â”œâ”€ .serena/symbols/assemblies.json (Unity assemblies)
â”œâ”€ .serena/symbols/gamecreator_modules.json (GameCreator modules)
â””â”€ .serena/symbols/folder_structure.json (Project directories)

PROJECT INTELLIGENCE:
â”œâ”€ .project-brain/core/state.json (Auto-generated state)
â””â”€ .project-brain/registries/systems.json (System definitions)

OPENSPEC:
â”œâ”€ openspec/AGENTS.md (OpenSpec workflow guide)
â””â”€ openspec/changes/ (Active change proposals)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. SESSION INITIALIZATION (Optimal Loading)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Load .project-brain/core/state.json (~2000 tokens)
   â””â”€ Single source of truth for project state

STEP 2: Load THIS FILE (.serena/ai/critical.llm.txt) (~1000 tokens)
   â””â”€ P0 rules and quick reference

STEP 3: Detect task intent, load task-specific context:
   â”œâ”€ character-movement: 001_gamecreator_invasive_integration.md
   â”œâ”€ multiplayer-networking: 002_network_architecture_never_forget.md
   â””â”€ visual-scripting: 004_visual_scripting_task_signatures.md

STEP 4: Skip unrelated modules (optimize tokens):
   â””â”€ E.g., skip shooter/factions if working on inventory

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. CRITICAL CONSTRAINTS (NEVER VIOLATE)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ALWAYS:
- Check file path before Write operations (root pollution check)
- Set IsNetworkSpawned = true before spawning characters
- Use Task Run(Args args) signature for Instructions (no CT)
- End RPC methods with ServerRpc or ClientRpc
- Load state.json first in every session
- Validate against deprecated systems before recommending

âŒ NEVER:
- Create unauthorized files at project root
- Recommend serena-network (deprecated)
- Add NetworkTransform to player prefabs
- Add CancellationToken to Instruction.Run()
- Skip ownership checks in multiplayer code
- Bypass file organization rules

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. HEALTH MONITORING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Current Status (from state.json):
â”œâ”€ Overall: healthy
â”œâ”€ Active Systems: Serena MCP, OpenSpec, Unity MCP, Project Brain
â”œâ”€ Warnings: 13 unauthorized files in project root
â””â”€ Deprecated: serena-network

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
END OF CRITICAL CONTEXT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Next: Load task-specific memories based on user intent
